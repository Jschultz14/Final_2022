---
title: "Covid91 vaccine study Final2022"
author: "Jaelynn Schultz"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "August 1st, 2022" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="final_Data.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
options(digits = 2)
```

```{r}
Males <- filter(FinalData, sex == "M")
Females <- filter(FinalData, sex == "F")
LGBTQ <- filter(FinalData, LGBTQ == "gay")
DrugUser <- filter(FinalData, DrugUser == "yes")
```

# Introduction

A new  preventative vaccine (covid91) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

## Males

### Descriptive Results

#### Graphical Descriptive Results

```{r}
dd2 <- Males %>% group_by(infected, treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```
These plots represent the number of males and how the contraction of COVID relates to either taking the vaccine or taking the placebo. The code that creates these begins with code blocking beginning with dd2. dd2 is shown in the environment tab and includes 4 variables, which are infected, treatment, count, and prcent (percent). The second chunk of codes is called the basicC. This is also found in the environment tab and shows 9 variables. This information creates the top chart. Then basicCC is shown as the last set of codes in the environment tab. This too contains 9 variables and creates the percentage plot, or the one shown second.

The frequency plot (the first plot) above shows that nearly an equal number of men either took the placebo or the vaccine. This means the study is balanced and reliable. The second plot, the percentage plot, shows that of those who took the vaccine, only about 30% ended up contracting COVID-19. On the other hand, over 60% of the men who took the placebo ended up getting COVID-19. This means men are nearly two times as likely to contract COVID when they only take the placebo. This would suggest that the vaccine is effective in preventing the contraction of COVID in males. 


Here's how these plots were read. In the first plot, the y-axis shows the count, which means the number of people who either got COVID-19 or not. The x-axis shows the number of those who were infected. In the second plot, the percentage plot, the two bars on the far left represent all of those who got COVID-19. The y-axis now represents the percentage of people who got COVID-19 after taking the vaccine or the placebo. The x-axis still shows whether or not a person got COVID-19 or did not.  
#### Numerical Descriptive Results

```{r}
table1 <- xtabs(~infected + treatment, data=Males)
rowPerc(table1)
colPerc(table1)
```

The numerical results above show the specific percentages of men who got COVID-19 after taking either the vaccine or the placebo. Of the males who took the vaccine, only 32.22% ended up getting COVID-19. However, of those who took the placebo, 67.78% of them contracted COVID. This supports the previous suggestion that the vaccine is effective in protecting males from COVID-19. As a matter of fact, it would seem that men who do not take the vaccine are about twice as likely to get COVID.

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
MaleFisher <- fisher.test(table1)
MaleFisher
```

Of the information above, perhaps the most valuable is the Fisher's Exact Test. As shown, p-value is very small (2.645e-11), which indicates that there is a statistical difference in the effectiveness of the placebo vs the vaccine in combating COVID-19 infections and it is not just by chance. This test also indicates by the odds ratio that males who take the placebo are around 2 times MORE likely to contract COVID than those who take the vaccine. 

### Efficacy of Vaccine in Males

```{r}
EfficacyMales <- ((2.092161/(1+2.092161)*100) )
EfficacyMales
```

```{r}
malefisherlow <-MaleFisher$conf.int[1]
malefisherlow
malefisherhigh <-MaleFisher$conf.int[2]
malefisherhigh
```

```{r}
EfficacyMalesLow <- (malefisherlow/(1+malefisherlow)*100)
EfficacyMalesLow
```

```{r}
EfficacyMalesHigh <- (malefisherhigh/(1+malefisherhigh)*100)
EfficacyMalesHigh
```

The information above shows the effectiveness of the COVID-19 vaccine in males. If the effectiveness shows to be above 50%, then we can conclude that the vaccine is effective in males. Given that the confidence interval of vaccine efficacy among males is between `r EfficacyMalesLow` to `r EfficacyMalesHigh`, which is well above 50, we can confirm that the vaccine is effective in preventing men from contracting COVID.

Additionally, the odds ratio above (68) shows exactly how effective the vaccine is. 

## Females

### Descriptive Results

#### Graphical Descriptive Results

```{r}
dd2 <- Females %>% group_by(infected, treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

These plots represent the number of females and the relationship between contracting COVID (or not) and whether one took the placebo or the vaccine. The code that creates the first begins with code block beginning with dd2. dd2 is shown in the environment tab and includes 4 variables, which include infected, treatment, count, and prcent (percent). The second chunk of codes is called the basicC. This is also found in the environment tab and shows 9 variables. This information creates the top chart. Then basicCC is shown as the last set of codes in the environment tab. This too contains 9 variables and creates the percentage plot, or the one shown second.

The frequency plot, the one shown first, shows that an almost equal amount of women took the placebo or the vaccines. This indicates that this study is balanced and reliable. The percentage plot, on the other hand, shows that around 40% of women who took the vaccine ended up contracting COVID. However, nearly 60% of women who took the placebo ended up getting COVID. This plot, similar to the last plot concerning the males, shows that those who take the placebo are considerably more likely to contract COVID in comparison to those who take the vaccine. 

Here's how these plots were read. In the first plot, the y-axis shows the count, which means the number of people who either got COVID-19 or not. The x-axis shows the number of those who were infected. In the second plot, the percentage plot, the two bars on the far left represent all of those who got COVID-19. The y-axis now represents the percentage of people who got COVID-19 after taking the vaccine or the placebo. The x-axis still shows whether or not a person got COVID-19 or did not.

#### Numerical Descriptive Results

```{r}
table1 <- xtabs(~infected + treatment, data=Females)
rowPerc(table1)
colPerc(table1)
```

These numerical results show the specific and accurate percentages of women who contracted COVID after taking either the placebo or the vaccine. Of those women who took the vaccine, a confirmed 40% of them ended up contracting COVID. However, approximately 59% of women who took the vaccine ended up getting COVID. This would further suggest that the vaccine is effective in protecting women from the Corona Virus, as women who take the vaccine simply are not nearly as likely to get COVID when compared to those who take the placebo.

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
FemaleFisher <- fisher.test(table1)
FemaleFisher
```

Of the results shown above, perhaps the most valuable is the information of the Fisher's Exact test. As shown, the p-value is extremely small at 9e-04. Being this small, the p-value insinuates that these results did not occur by chance or luck. 

### Efficacy of Vaccine in Females

## LGBTQ

### Descriptive Results

#### Graphical Descriptive Results

#### Numerical Descriptive Results

### Inferential Results

### Efficacy of Vaccine for LGBTQ

## Druggies

### Descriptive Results

#### Graphical Descriptive Results

#### Numerical Descriptive Results

### Inferential Results

### Efficacy of Vaccine in Druggies
